# ğŸŒ¿ Personal Health - ç²¾æº–å€‹äººåŒ–å¥åº·ç®¡ç†ç³»çµ±

> **AI Native å¥åº·ç®¡ç†å¹³å°**ï¼šçµåˆ Gemini AIã€OCR æ™ºèƒ½è§£æã€RAG çŸ¥è­˜åº«ã€å€‹äººåŒ–ç‡Ÿé¤Šå»ºè­°ï¼Œæ‰“é€ æ‚¨çš„å°ˆå±¬å¥åº·æ•™ç·´ã€‚

[![Flutter](https://img.shields.io/badge/Flutter-3.27-02569B?logo=flutter)](https://flutter.dev)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104-009688?logo=fastapi)](https://fastapi.tiangolo.com)
[![Gemini](https://img.shields.io/badge/Gemini-3.0%20Flash-4285F4?logo=google)](https://ai.google.dev)
[![Python](https://img.shields.io/badge/Python-3.13-3776AB?logo=python)](https://python.org)

---

## âš¡ å¿«é€Ÿé–‹å§‹

> **âœ… Webç³»çµ±å·²å®Œå…¨ä¿®å¾©ä¸¦å°±ç·’ï¼** (2026-01-18)

### ğŸš€ 3æ­¥å•Ÿå‹•

```powershell
cd C:\Users\User\Desktop\personalhealth
python run_system.py
```

è¨ªå•: **http://localhost:8501**

ğŸ“š **[å¿«é€Ÿé–‹å§‹æŒ‡å—](QUICK_START_WEB.md)** | ğŸ“‹ **[åŸ·è¡Œæ‘˜è¦](EXECUTIVE_SUMMARY.md)** | ğŸ“– **[å®Œæ•´æ–‡æª”](WEB_SYSTEM_ANALYSIS.md)**

---

## ğŸ†• 2026-01-18 æ›´æ–°é‡é»ï¼ˆå·²ä¸Šç·šï¼‰

- **é£Ÿæå°é½Šï¼ˆFood Alignmentï¼‰**ï¼šæŠŠä½¿ç”¨è€…è¼¸å…¥ï¼ˆå¦‚ã€Œé›èƒ¸è‚‰ã€ï¼‰å°é½Šåˆ°å°ç£é£Ÿå“è³‡æ–™åº«æ¬Šå¨ `food_id`ï¼Œé¿å… AI å¹»è¦ºæ•¸å­—ã€‚
- **é£²é£Ÿç´€éŒ„ï¼ˆMeal Loggingï¼‰**ï¼šæ–°å¢é¤æ¬¡èˆ‡é¤é»é …ç›®ï¼Œæ”¯æ´å¤šé£Ÿæã€å…‹æ•¸ã€ä¾†æºã€è¿‘ 7 æ—¥ç¸½çµèˆ‡è¿‘æœŸåˆ—è¡¨ã€‚
- **åå¹»è¦ºç‡Ÿé¤Šè¨ˆç®—ï¼ˆDB-driven Nutritionï¼‰**ï¼šæ‰€æœ‰ç‡Ÿé¤Šæ•¸å€¼ä»¥è³‡æ–™åº«/CSV ç‚ºæº–ï¼Œå‰ç«¯/LLM åªè² è²¬ã€Œæè¿°èˆ‡é¸æ“‡ã€ï¼Œä¸è² è²¬ã€Œç·¨æ•¸å­—ã€ã€‚
- **è‡ªå‹•åŒ–é©—æ”¶**ï¼šæ–°å¢ API ç«¯åˆ°ç«¯é©—è­‰èˆ‡ Web UI smoke testï¼ˆPlaywrightï¼‰ã€‚
- **æ‹ç…§è¾¨è­˜/ä»½é‡ä¼°ç®—è©•ä¼°**ï¼šæ–°å¢å¯¦å‹™å¯è¡Œæ€§è©•ä¼°èˆ‡è½åœ°è·¯ç·šï¼ˆMVP â†’ LiDAR/æ·±åº¦/å•†æ¥­APIï¼‰æ–‡ä»¶ï¼š`docs/PHOTO_FOOD_RECOGNITION_PORTION_ESTIMATION_FEASIBILITY_2026.md`ã€‚

---

## ğŸ†• 2026-01-19 å‰ç«¯é«”é©—æ›´æ–°ï¼ˆå·²ä¸Šç·šï¼‰

- **Profile æœªå®Œæˆæé†’**ï¼šæœªå¡«å¯«åŸºæœ¬è³‡æ–™å°±é€²å…¥å…¶ä»–é¸å–®æœƒæç¤ºä¸¦å¼•å°å› Profileã€‚
- **æ‹ç…§/ç›¸ç°¿åˆ†é›¢**ï¼šé¤é»æ‹ç…§å…¥å£æ˜ç¢ºå€åˆ†ã€Œæ‹ç…§ã€èˆ‡ã€Œç›¸ç°¿ã€ã€‚
- **å„²å­˜æŒ‰éˆ•å¼·åŒ–**ï¼šProfileã€Œå„²å­˜è³‡æ–™ã€æŒ‰éˆ•æ›´é¡¯è‘—ï¼ˆåœ–ç¤ºã€å­—é‡èˆ‡é«˜åº¦ï¼‰ã€‚

## ğŸ”„ 2026-01-19 ä¼ºæœå™¨åŒæ­¥æ›´æ–°

### å¾Œç«¯ç°¡åŒ–
- **`app/api/v1/endpoints/users.py`** é‡æ§‹ï¼š
  - ç§»é™¤è¤‡é›œçš„å„€è¡¨æ¿é‚è¼¯ï¼ˆæš«æ™‚ï¼‰
  - ä¿ç•™æ ¸å¿ƒ 3 å€‹ç«¯é»ï¼š`/me/profile`ã€`/me/nutrition-targets`ã€`/me/dashboard`
  - æ–°å¢ Profile å®Œæˆç‹€æ…‹æª¢æŸ¥ï¼ˆç”¨æ–¼å‰ç«¯ guardï¼‰

### éƒ¨ç½²æ”¹å–„
- **`deploy/Caddyfile`** å¿«å–å„ªåŒ–ï¼š
  - å° `index.html`ã€`flutter_service_worker.js`ã€`manifest.json`ã€`version.json` ç¦ç”¨ç€è¦½å™¨å¿«å–
  - è§£æ±º Flutter Service Worker æ›´æ–°å»¶é²å•é¡Œ
  - æ–°å¢ `no-cache, no-store, must-revalidate` æ¨™é ­

---

## ğŸ§ª é©—æ”¶èˆ‡æ¸¬è©¦ï¼ˆå»ºè­°å…ˆè·‘é€™äº›ï¼‰

### 1) API ç«¯åˆ°ç«¯é©—æ”¶ï¼ˆæ¨è–¦ï¼‰

ç¢ºèªå¾Œç«¯å·²å•Ÿå‹•ï¼ˆæˆ–å…ˆåŸ·è¡Œ `python run_system.py`ï¼‰ï¼Œå†è·‘ï¼š

```powershell
cd C:\Users\User\Desktop\personalhealth
python verify_2026_features.py
```

### 2) Web UI è‡ªå‹•åŒ– Smoke Testï¼ˆPlaywrightï¼‰

ä¸€æ¬¡æ€§å®‰è£ç€è¦½å™¨ï¼ˆåªéœ€ç¬¬ä¸€æ¬¡ï¼‰ï¼š

```powershell
cd C:\Users\User\Desktop\personalhealth
python -m playwright install chromium
```

åŸ·è¡Œ UI smoke testï¼ˆæœƒå•Ÿå‹• Streamlitã€è·‘æ¸¬è©¦ã€å†é—œé–‰ Streamlitï¼›å¾Œç«¯éœ€åœ¨ 8000 é‹è¡Œï¼‰ï¼š

```powershell
cd C:\Users\User\Desktop\personalhealth
.\run_ui_smoke_test.ps1
```

---

## ğŸ”Œ ä¸»è¦ APIï¼ˆ2026 æ ¸å¿ƒï¼‰

| åŠŸèƒ½ | Method | Path |
|---|---:|---|
| å¥åº·æª¢æŸ¥ | GET | `/health` |
| å»ºç«‹ä½¿ç”¨è€… | POST | `/api/v1/users/` |
| é£Ÿæåç¨±å°é½Š | GET | `/api/v1/food/align?q=é›èƒ¸è‚‰&limit=5` |
| å»ºç«‹é¤æ¬¡ | POST | `/api/v1/meals` |
| åˆ—å‡ºè¿‘æœŸé¤æ¬¡ | GET | `/api/v1/meals?user_id=...&limit=10` |
| è¿‘ N æ—¥ç‡Ÿé¤Šç¸½çµ | GET | `/api/v1/meals/summary?user_id=...&days=7` |

---

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

Personal Health æ˜¯ä¸€å€‹å®Œæ•´çš„ **ç«¯åˆ°ç«¯å¥åº·æ•¸æ“šç®¡ç†èˆ‡ AI åˆ†æç³»çµ±**ï¼Œé€éå…ˆé€²çš„ AI æŠ€è¡“ï¼ˆGemini 3.0 Flashï¼‰ã€RAG çŸ¥è­˜æª¢ç´¢ã€ç‡Ÿé¤Šè³‡æ–™åº«æ•´åˆï¼Œæä¾›ç²¾æº–çš„å€‹äººåŒ–å¥åº·å»ºè­°ã€‚

### ğŸ¯ æ ¸å¿ƒåƒ¹å€¼
- ğŸ¤– **Gemini 3.0 Flash é©…å‹•**ï¼šå¤šæ¨¡æ…‹ Vision OCR + ä¸¦è¡Œæ¨è–¦ç”Ÿæˆï¼ˆ26 ç§’å®Œæˆå®Œæ•´æµç¨‹ï¼Œé€Ÿåº¦æ¯” Pro å¿« 2.7 å€ï¼‰
- ğŸ“¸ **æ™ºèƒ½ OCR**ï¼šè‡ªå‹•è­˜åˆ¥å°ç£å¥æª¢å ±å‘Šï¼ˆæ”¯æ´ 40+ æª¢é©—é …ç›®ï¼‰ï¼Œå¹³å‡ 15 ç§’æå–çµæ§‹åŒ–æ•¸æ“š
- ğŸ“Š **è¶¨å‹¢è¿½è¹¤**ï¼šæ­·å²æ•¸æ“šå°æ¯”ï¼Œå‹•æ…‹å¥åº·è©•åˆ†ï¼ˆ0-100 åˆ†ï¼‰
- ğŸ’¬ **RAG å°è©±ç³»çµ±**ï¼šContext-Aware AI ç‡Ÿé¤Šå¸«ï¼ŒåŸºæ–¼å°ˆæ¥­çŸ¥è­˜åº«å›ç­”ï¼ˆä¸æ†‘ç©ºå¹»è¦ºï¼‰
- ğŸ **ç‡Ÿé¤Šè³‡æ–™åº«æ•´åˆ**ï¼šå°ç£é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº« 2024ï¼ˆ2,180 é£Ÿç‰© Ã— 110 ç‡Ÿé¤Šç´ ï¼‰
- ğŸ“± **è·¨å¹³å°**ï¼šWeb (Streamlit) + Mobile (Flutter iOS/Android/Windows Desktop)

### ğŸ† æŠ€è¡“äº®é»
- **RAG æ¶æ§‹**ï¼šæª¢ç´¢å¢å¼·ç”Ÿæˆï¼ˆKnowledge Base + Contextï¼‰ï¼Œé¿å… AI å¹»è¦º
- **ä¸¦è¡Œ AI ç”Ÿæˆ**ï¼šasyncio ä¸¦è¡Œå‘¼å« 3 å€‹ AI æ¨¡çµ„ï¼Œé€Ÿåº¦æå‡ 3 å€
- **å‹•æ…‹å¥åº·è©•åˆ†**ï¼šåŸºæ–¼é¢¨éšªè©•ä¼°è‡ªå‹•è¨ˆç®— 0-100 åˆ†å¥åº·æŒ‡æ•¸
- **Phase 1 ç‡Ÿé¤Šæ•´åˆ**ï¼š100% Top 20 é£Ÿç‰©åŒ¹é…ç‡ï¼Œ0.66ms æŸ¥è©¢æ•ˆèƒ½
- **å®Œæ•´ Pydantic é©—è­‰**ï¼šType-safe API with strict schema validation

---

## ğŸ—ï¸ å®Œæ•´æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Personal Health System                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‰ç«¯å±¤ (Frontend) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Streamlit Web   â”‚        â”‚   Flutter Mobile/Desktop   â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚        â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  â€¢ Dashboard     â”‚        â”‚  â€¢ Profile (è¡¨å–®é©—è­‰)        â”‚  â”‚
â”‚  â”‚  â€¢ Upload        â”‚        â”‚  â€¢ Upload (Camera/Gallery)  â”‚  â”‚
â”‚  â”‚  â€¢ Chat          â”‚        â”‚  â€¢ Dashboard (fl_chart)     â”‚  â”‚
â”‚  â”‚  â€¢ Charts        â”‚        â”‚  â€¢ Chat (Auto-scroll UX)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â€¢ Nutrition Search (ç¨ç«‹)  â”‚  â”‚
â”‚          â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                          â”‚ HTTP REST API                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ å¾Œç«¯å±¤ (Backend) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚            FastAPI Application (app/main.py)        â”‚     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚     â”‚
â”‚  â”‚  â€¢ JWT Auth (è¦åŠƒä¸­)                                 â”‚     â”‚
â”‚  â”‚  â€¢ CORS Middleware                                  â”‚     â”‚
â”‚  â”‚  â€¢ Pydantic v2.12 Schema Validation                â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                          â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â–¼                â–¼                â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   OCR API   â”‚  â”‚   AI API     â”‚  â”‚ Nutrition APIâ”‚        â”‚
â”‚  â”‚  /api/v1/   â”‚  â”‚  /api/v1/    â”‚  â”‚  /api/v1/    â”‚        â”‚
â”‚  â”‚  ocr/       â”‚  â”‚  recommend   â”‚  â”‚  nutrition/  â”‚        â”‚
â”‚  â”‚  upload     â”‚  â”‚  /generate   â”‚  â”‚  search      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â”‚         â”‚  /chat/msg   â”‚         â”‚                â”‚
â”‚         â–¼         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               Service Layer (æ¥­å‹™é‚è¼¯)               â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚ ocr_service  â”‚  â”‚ ai_service   â”‚  â”‚ nutrition â”‚ â”‚    â”‚
â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ _db_svc   â”‚ â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ Vision API â”‚  â”‚ â€¢ RAG Engine â”‚  â”‚ â€¢ Search  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ 40+ fields â”‚  â”‚ â€¢ Parallel   â”‚  â”‚ â€¢ Calculateâ”‚ â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ Validation â”‚  â”‚ â€¢ Risk Assessâ”‚  â”‚ â€¢ Aliases â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                           â”‚                          â”‚    â”‚
â”‚  â”‚                           â–¼                          â”‚    â”‚
â”‚  â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚                  â”‚ knowledge_serviceâ”‚               â”‚    â”‚
â”‚  â”‚                  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚               â”‚    â”‚
â”‚  â”‚                  â”‚ â€¢ RAG Retrieval  â”‚               â”‚    â”‚
â”‚  â”‚                  â”‚ â€¢ 3 MD files     â”‚               â”‚    â”‚
â”‚  â”‚                  â”‚ â€¢ Tag Matching   â”‚               â”‚    â”‚
â”‚  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ è³‡æ–™å±¤ (Data) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   SQLite DB  â”‚  â”‚  Knowledge Base â”‚  â”‚ Nutrition DB   â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  â€¢ Users     â”‚  â”‚  â€¢ general_     â”‚  â”‚  â€¢ 2,180 foods â”‚  â”‚
â”‚  â”‚  â€¢ Reports   â”‚  â”‚    guidelines.mdâ”‚  â”‚  â€¢ 110 fields  â”‚  â”‚
â”‚  â”‚  â€¢ History   â”‚  â”‚  â€¢ supplement_  â”‚  â”‚  â€¢ CSV/Pandas  â”‚  â”‚
â”‚  â”‚              â”‚  â”‚    safety.md    â”‚  â”‚  â€¢ Top 20 Map  â”‚  â”‚
â”‚  â”‚              â”‚  â”‚  â€¢ drug_        â”‚  â”‚                â”‚  â”‚
â”‚  â”‚              â”‚  â”‚    interactions â”‚  â”‚                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ å¤–éƒ¨æœå‹™ (External) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â–¼                                    â”‚
â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                â”‚  Google Gemini API   â”‚                       â”‚
â”‚                â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                       â”‚
â”‚                â”‚  â€¢ Model: gemini-3-  â”‚                       â”‚
â”‚                â”‚    pro-preview       â”‚                       â”‚
â”‚                â”‚  â€¢ Vision OCR        â”‚                       â”‚
â”‚                â”‚  â€¢ Chat Generation   â”‚                       â”‚
â”‚                â”‚  â€¢ Async + Timeout   â”‚                       â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Œ æ ¸å¿ƒæŠ€è¡“è©³è§£

### 1ï¸âƒ£ **OCR æ™ºèƒ½è§£æå¼•æ“**

**æŠ€è¡“æ£§**ï¼šGoogle Gemini Vision API (å¤šæ¨¡æ…‹ AI)

**æ”¯æ´é …ç›®** (40+ æª¢é©—é …ç›®è‡ªå‹•è­˜åˆ¥)ï¼š
```python
# è¡€æ¶²å¸¸è¦ï¼šWBC, RBC, Hb, Hct, PLT, MCV, MCH, MCHC
# è‚åŠŸèƒ½ï¼šGOT, GPT, Î³-GT, ALP, Total Bilirubin
# è…åŠŸèƒ½ï¼šBUN, Creatinine, eGFR, Uric Acid
# è¡€è„‚ï¼šT-CHO, TG, HDL-C, LDL-C
# è¡€ç³–ï¼šGlucose, HbA1c
# ç”²ç‹€è…ºï¼šTSH, Free T4
# é›»è§£è³ªï¼šNa, K, Cl, Ca
# ... å®Œæ•´ 40+ é …ç›®
```

**å¯¦ç¾æ©Ÿåˆ¶**ï¼š
```python
# app/services/ocr_service.py
async def extract_health_data(image_path):
    """
    1. åœ–ç‰‡å‰è™•ç†ï¼ˆæ ¼å¼è½‰æ›ã€å£“ç¸®ï¼‰
    2. Gemini Vision API è§£æï¼ˆStructured Promptï¼‰
    3. JSON Schema é©—è­‰ï¼ˆPydanticï¼‰
    4. ç•°å¸¸å€¼æª¢æ¸¬ï¼ˆè‡ªå‹•æ¨™è¨˜ high/low/normalï¼‰
    """
```

**è¼¸å‡ºæ ¼å¼**ï¼š
```json
{
  "glucose": {"value": 169, "unit": "mg/dL", "status": "high"},
  "hba1c": {"value": 5.8, "unit": "%", "status": "normal"},
  "egfr": {"value": 76.38, "unit": "mL/min/1.73mÂ²", "status": "low"}
}
```

---

### 2ï¸âƒ£ **AI æ¨è–¦å¼•æ“ (RAG + Parallel Generation)**

**æ ¸å¿ƒå‰µæ–°**ï¼š
- âœ… **RAG æ¶æ§‹**ï¼šæª¢ç´¢å¢å¼·ç”Ÿæˆï¼Œé¿å… AI å¹»è¦º
- âœ… **ä¸¦è¡Œç”Ÿæˆ**ï¼šasyncio.gather() åŒæ™‚ç”Ÿæˆ 3 å€‹æ¨¡çµ„
- âœ… **å‹•æ…‹å¥åº·è©•åˆ†**ï¼šåŸºæ–¼é¢¨éšªè©•ä¼°è¨ˆç®— 0-100 åˆ†

#### **RAG çŸ¥è­˜æª¢ç´¢ç³»çµ±**
```python
# app/services/knowledge_service.py
class KnowledgeService:
    """
    çŸ¥è­˜åº«é è¼‰æ©Ÿåˆ¶ï¼ˆå•Ÿå‹•æ™‚è¼‰å…¥è¨˜æ†¶é«”ï¼‰
    
    ç­–ç•¥ï¼š
    1. å¿…è¼‰ï¼šgeneral_guidelines.md, supplement_safety.md
    2. æ¢ä»¶è¼‰å…¥ï¼šæ ¹æ“šç•°å¸¸æŒ‡æ¨™ tags åŒ¹é…
    3. é—œéµå­—æª¢ç´¢ï¼šç°¡å–®ä½†æœ‰æ•ˆçš„å­—ä¸²åŒ¹é…
    """
    
    def get_relevant_context(self, tags: List[str]) -> str:
        # æª¢ç´¢èˆ‡ tags ç›¸é—œçš„çŸ¥è­˜ç« ç¯€
        # ä¾‹å¦‚ï¼štags=['blood_sugar', 'kidney'] 
        #      â†’ è¿”å›ç³–å°¿ç—…é£²é£Ÿ + è…åŠŸèƒ½ä¿é¤ŠçŸ¥è­˜
```

**çŸ¥è­˜åº«å…§å®¹**ï¼š
| æª”æ¡ˆ | å…§å®¹ | å­—æ•¸ |
|------|------|------|
| `general_guidelines.md` | å°ç£æ¯æ—¥é£²é£ŸæŒ‡å—ã€å…­å¤§é¡é£Ÿç‰©å»ºè­° | ~1,200 å­— |
| `supplement_safety.md` | ä¿å¥å“å®‰å…¨ã€åŠ‘é‡ä¸Šé™ã€ç‰¹æ®Šæ—ç¾¤è­¦ç¤º | ~800 å­— |
| `drug_interactions.md` | è—¥ç‰©äº¤äº’ä½œç”¨ã€ç¦å¿Œçµ„åˆ | ~600 å­— |

#### **ä¸¦è¡Œ AI ç”Ÿæˆ**
```python
# app/services/ai_service.py
async def generate_comprehensive_report(...):
    """
    ä¸¦è¡Œç”Ÿæˆ 3 å€‹ AI æ¨¡çµ„ï¼š
    1. food_advice      (é£²é£Ÿå»ºè­° ~2,915 å­—)
    2. supplement_advice (ä¿å¥å“å»ºè­° ~2,173 å­—)
    3. meal_plan        (7 å¤©é¤è¨ˆåŠƒ ~3,056 å­—)
    
    æ€§èƒ½ï¼š44.39s å®Œæˆå…¨éƒ¨ç”Ÿæˆï¼ˆvs é †åºåŸ·è¡Œ ~130sï¼‰
    """
    results = await asyncio.gather(
        self._generate_food_advice(context),
        self._generate_supplement_advice(context, health_data),
        self._generate_meal_plan(context),
        return_exceptions=True
    )
```

#### **å‹•æ…‹å¥åº·è©•åˆ†ç®—æ³•**
```python
def calculate_health_score(risk_assessment: dict) -> int:
    """
    åŸºæ–¼é¢¨éšªè©•ä¼°è¨ˆç®— 0-100 åˆ†å¥åº·æŒ‡æ•¸
    
    æ‰£åˆ†è¦å‰‡ï¼š
    - High Risk: -20 åˆ†/é …
    - Medium Risk: -10 åˆ†/é …
    - Low Risk: -5 åˆ†/é …
    
    ç¯„ä¾‹ï¼š
    - è¡€ç³– High (169) + eGFR Low (76.38) = 100 - 20 - 10 = 70 åˆ†
    - å¯¦éš›æ¸¬è©¦ï¼š82/100 (è‰¯å¥½)
    """
```

---

### 3ï¸âƒ£ **Chat å°è©±ç³»çµ± (Context-Aware AI)**

**æŠ€è¡“æ¶æ§‹**ï¼šRAG + Context + History Management

#### **å°è©±æµç¨‹**
```
ç”¨æˆ¶æå•ï¼šã€Œæˆ‘å¯ä»¥åƒé¦™è•‰å—ï¼Ÿã€
     â†“
å‰ç«¯æ”¶é›† Contextï¼š
 â€¢ user_id: 123
 â€¢ message: "æˆ‘å¯ä»¥åƒé¦™è•‰å—ï¼Ÿ"
 â€¢ context: {è¡€ç³– 169, eGFR 76.38, ...}  â† å¥åº·å ±å‘Š
 â€¢ history: [å‰ 10 è¼ªå°è©±]                â† å°è©±æ­·å²
     â†“
POST /api/v1/chat/message
     â†“
å¾Œç«¯ ai_serviceï¼š
 1. RAG æª¢ç´¢ï¼štags=['blood_sugar', 'kidney']
    â†’ æ‰¾åˆ°ã€Œè…åŠŸèƒ½æ‚£è€…é«˜é‰€è­¦ç¤ºã€
 2. å»ºæ§‹ Promptï¼š
    Persona + çŸ¥è­˜åº« + å¥åº·å ±å‘Š + æ­·å² + ç•¶å‰å•é¡Œ
 3. Gemini API ç”Ÿæˆå›æ‡‰
     â†“
AI å›æ‡‰ï¼šã€Œæ‚¨çš„ eGFR 76.38 å±¬æ–¼è¼•åº¦è…åŠŸèƒ½ä¸‹é™ï¼Œ
         é¦™è•‰å«é‰€é‡é«˜ï¼ˆç´„ 358mg/100gï¼‰ï¼Œå»ºè­°...ã€
```

#### **Prompt Engineering ç­–ç•¥**
```python
system_prompt = f"""
# Persona
You are "Health Coach" (AI Nutritionist), 
warm, professional, and knowledgeable about Taiwan's food culture.

# Knowledge Base (Available Source of Truth)
{professional_knowledge}  # â† RAG æª¢ç´¢çš„çŸ¥è­˜

# Instructions
1. Answer User's question clearly.
2. ALWAYS ground your answer in the provided 'Knowledge Base'.
3. **Safety First**: Check interactions for drugs/supplements.
4. Keep it conversational but concise.

# Context (User Report)
{å¥åº·å ±å‘Š JSON}

# Chat History (æœ€è¿‘ 10 è¼ª)
User: æˆ‘çš„è¡€ç³–æ€éº¼è¾¦ï¼Ÿ
Nutritionist: æ‚¨çš„è¡€ç³– 169...

ç¾åœ¨ User èªª: {message}

Nutritionist:
"""
```

#### **ç‹€æ…‹ç®¡ç† (Riverpod)**
```dart
// mobile/flutter_app/lib/state/app_state.dart
final chatHistoryProvider = StateProvider<List<Map<String, dynamic>>>([]);

// è‡ªå‹•ç®¡ç†ï¼š
// - æ·»åŠ ç”¨æˆ¶è¨Šæ¯
// - æ·»åŠ  AI å›è¦†
// - é™åˆ¶æœ€è¿‘ 10 è¼ªï¼ˆç¯€çœ Tokenï¼‰
// - æ¸…é™¤å°è©±
```

---

### 4ï¸âƒ£ **ç‡Ÿé¤Šè³‡æ–™åº«æ•´åˆ (Phase 1 MVP)**

**æ•¸æ“šä¾†æº**ï¼šå°ç£é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº« 2024 UPDATE2

**çµ±è¨ˆæ•¸æ“š**ï¼š
- ğŸ“Š **2,180 é£Ÿç‰©**
- ğŸ“‹ **110 ç‡Ÿé¤Šæ¬„ä½** (æ¯ 100g)
- ğŸ·ï¸ **18 é£Ÿå“åˆ†é¡**

#### **Phase 1 é©—æ”¶çµæœ**
| æŒ‡æ¨™ | ç›®æ¨™ | å¯¦éš› | ç‹€æ…‹ |
|------|------|------|------|
| Top 20 åŒ¹é…ç‡ | â‰¥80% | **100%** | âœ… |
| æŸ¥è©¢æ•ˆèƒ½ | <100ms | **0.66ms** | âœ… |
| è³‡æ–™å®Œæ•´æ€§ | â‰¥2000ç­† | **2,180ç­†** | âœ… |

#### **æœå°‹ç®—æ³•**
```python
# app/services/nutrition_db_service.py
def search(query: str, limit: int = 5):
    """
    å¤šå±¤åŒ¹é…ç­–ç•¥ï¼š
    1. ç²¾ç¢ºåŒ¹é…ï¼šã€Œç™½é£¯ã€ â†’ ç™½é£¯
    2. åˆ¥ååŒ¹é…ï¼šã€Œé¦™è•‰ã€ â†’ åŒ—è•‰å¹³å‡å€¼ï¼ˆå°ç£ç”¨è©ï¼‰
    3. æ¨¡ç³ŠåŒ¹é…ï¼šã€Œé›ã€ â†’ é›èƒ¸è‚‰ã€é›è›‹ã€é›æ¹¯...
    4. åˆ†è©åŒ¹é…ï¼šã€Œç´…è˜¿è””ã€ â†’ ã€Œç´…ã€+ã€Œè˜¿ã€+ã€Œè””ã€
    """
```

#### **åˆ¥åæ˜ å°„è¡¨ (Top 20)**
```python
FOOD_ALIASES = {
    'ç™½é£¯': ['ç±³é£¯', 'ç™½ç±³é£¯', 'è“¬èŠç±³é£¯'],
    'é¦™è•‰': ['é¦™è•‰', 'èŠ­è•‰', 'åŒ—è•‰'],  # å°ç£ç¨±ã€ŒåŒ—è•‰ã€
    'é›èƒ¸è‚‰': ['é›èƒ¸', 'é›é‡Œè‚Œ', 'é›æŸ³'],
    # ... å…± 20 é …é«˜é »é£Ÿç‰©
}
```

#### **API ç«¯é»**
```bash
# æœå°‹é£Ÿç‰©
GET /api/v1/nutrition/search?q=é›èƒ¸è‚‰&limit=5

# è¨ˆç®—ç‡Ÿé¤Š
GET /api/v1/nutrition/calculate?food=ç™½é£¯&grams=200

# å–å¾—çµ±è¨ˆ
GET /api/v1/nutrition/stats

# é©—è­‰åŒ¹é…ç‡
GET /api/v1/nutrition/validate
```

#### **Flutter ç¨ç«‹æŸ¥è©¢é **
```dart
// lib/pages/nutrition_search_page.dart
// 
// åŠŸèƒ½ï¼š
// - æœå°‹é£Ÿç‰©ï¼ˆæ”¯æ´æ¨¡ç³ŠåŒ¹é…ï¼‰
// - è¼¸å…¥å…‹æ•¸è¨ˆç®—ç‡Ÿé¤Š
// - ç¾è§€å¡ç‰‡å±•ç¤ºï¼ˆç†±é‡ã€è›‹ç™½è³ªã€ç¢³æ°´ã€è„‚è‚ªã€éˆ‰ã€é‰€ã€çº–ç¶­ï¼‰
// - é»æ“Šé£Ÿç‰©è‡ªå‹•è¨ˆç®—æŒ‡å®šå…‹æ•¸
```

---

### 5ï¸âƒ£ **Pydantic Schema é©—è­‰ç³»çµ±**

**ç‚ºä»€éº¼é‡è¦**ï¼šé˜²æ­¢ `__risk_assessment__` æ±¡æŸ“å¥åº·æ•¸æ“šå°è‡´ 500 éŒ¯èª¤

#### **æ ¸å¿ƒ Schema**
```python
# app/schemas/analysis.py
class HealthMetricStatus(BaseModel):
    """å–®ä¸€å¥åº·æŒ‡æ¨™"""
    value: float
    unit: str
    status: str  # "normal" | "high" | "low"

class NutritionReport(BaseModel):
    """å®Œæ•´ç‡Ÿé¤Šå ±å‘Š"""
    health_data_snapshot: Dict[str, HealthMetricStatus]  # â† åš´æ ¼é©—è­‰
    health_score: int = Field(ge=0, le=100)
    food_advice: List[AdviceSection]
    supplement_advice: List[AdviceSection]
    meal_plan: Dict[str, Any]
```

#### **é—œéµä¿®å¾©**
```python
# âŒ éŒ¯èª¤ï¼ˆæœƒå°è‡´ ValidationErrorï¼‰
health_data['__risk_assessment__'] = {...}  # å…§éƒ¨æ¬„ä½ä¸ç¬¦åˆ Schema
return NutritionReport(health_data_snapshot=health_data)

# âœ… æ­£ç¢ºï¼ˆåˆ†é›¢å…§éƒ¨æ•¸æ“šï¼‰
risk_assessment = analyze_health_risks(health_data)
clean_data = {k: v for k, v in health_data.items() 
              if not k.startswith("__")}
return NutritionReport(
    health_data_snapshot=clean_data,
    health_score=extract_score(risk_assessment)
)
```

---

## ğŸ“± Flutter å‰ç«¯æŠ€è¡“æ¶æ§‹

### **æŠ€è¡“æ£§**
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Flutter** | 3.27+ | è·¨å¹³å° UI æ¡†æ¶ |
| **Riverpod** | 2.5.1 | ç‹€æ…‹ç®¡ç† |
| **Dio** | 5.x | HTTP å®¢æˆ¶ç«¯ |
| **fl_chart** | 0.68.0 | åœ–è¡¨ç¹ªè£½ |
| **flutter_markdown** | 0.7.4 | Markdown æ¸²æŸ“ |
| **image_picker** | Latest | ç›¸æ©Ÿ/ç›¸ç°¿é¸å– |

### **é é¢æ¶æ§‹**
```dart
HomeShell (Bottom Navigation)
â”œâ”€â”€ Profile Page    (å€‹äººè³‡æ–™ç®¡ç† + è¡¨å–®é©—è­‰)
â”œâ”€â”€ Upload Page     (å¥æª¢å ±å‘Šä¸Šå‚³ + OCR)
â”œâ”€â”€ Dashboard Page  (å¥åº·å„€è¡¨æ¿ + è¶¨å‹¢åœ–)
â””â”€â”€ Chat Page       (AI å°è©± + UX å„ªåŒ–)

ç¨ç«‹é é¢ï¼š
â”œâ”€â”€ Report Detail Page    (Markdown å®Œæ•´å ±å‘Šé¡¯ç¤º)
â””â”€â”€ Nutrition Search Page (ç‡Ÿé¤ŠæŸ¥è©¢ Phase 1)
```

### **Riverpod ç‹€æ…‹ç®¡ç†**
```dart
// å…¨åŸŸç‹€æ…‹
final userProfileProvider = StateProvider<UserProfile>();
final healthReportsProvider = StateProvider<List<NutritionReport>>([]);
final chatHistoryProvider = StateProvider<List<Map>>([]);

// API æœå‹™
final reportServiceProvider = Provider((ref) => ReportService());
final chatServiceProvider = Provider((ref) => ChatService());
final nutritionServiceProvider = Provider((ref) => NutritionService());

// ç¯„ä¾‹ä½¿ç”¨
final profile = ref.watch(userProfileProvider);
final service = ref.read(reportServiceProvider);
```

---

## ğŸš€ é–‹ç™¼è€…å•Ÿå‹•ï¼ˆæ‰‹å‹•/é™¤éŒ¯ç”¨ï¼‰

> ä¸€èˆ¬ä½¿ç”¨å»ºè­°ç›´æ¥è·‘ `python run_system.py`ï¼ˆæœƒåŒæ™‚å•Ÿå‹•å¾Œç«¯ + Web UIï¼‰ã€‚

### 1) ç’°å¢ƒéœ€æ±‚
- Python 3.10+ï¼ˆå·²åœ¨ Python 3.13 é©—è­‰ï¼‰
- Flutter 3.27+ï¼ˆåƒ… Mobile/æ¡Œé¢ App éœ€è¦ï¼‰
- Google Gemini API Keyï¼ˆOCR/AI å»ºè­°éœ€è¦ï¼‰

### 2) å®‰è£ä¾è³´
```powershell
cd C:\Users\User\Desktop\personalhealth
pip install -r requirements.txt
```

### 3) åˆå§‹åŒ–è³‡æ–™åº«ï¼ˆç¬¬ä¸€æ¬¡åŸ·è¡Œéœ€è¦ï¼‰
```powershell
cd C:\Users\User\Desktop\personalhealth
python -m app.init_db
```

### 4) å•Ÿå‹•å¾Œç«¯ API
```powershell
cd C:\Users\User\Desktop\personalhealth
python start_backend.py
```

### 5) å•Ÿå‹• Web UIï¼ˆStreamlitï¼‰
```powershell
cd C:\Users\User\Desktop\personalhealth
python -m streamlit run frontend/main.py
```

### 4. Flutter App å•Ÿå‹•
```bash
cd mobile/flutter_app

# å®‰è£ä¾è³´
flutter pub get

# Windows æ¡Œé¢ç‰ˆ
flutter run -d windows

# Android/iOS (éœ€æ¨¡æ“¬å™¨æˆ–çœŸæ©Ÿ)
flutter run

# ç’°å¢ƒé…ç½® (è©³è¦‹ ENV_CONFIG.md)
flutter run --dart-define=ENV=development
```

---

## ğŸ› ï¸ å®Œæ•´å°ˆæ¡ˆçµæ§‹

```
personalhealth/
â”œâ”€â”€ app/                          # FastAPI å¾Œç«¯
â”‚   â”œâ”€â”€ main.py                   # ä¸»ç¨‹å¼å…¥å£
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â””â”€â”€ endpoints/
â”‚   â”‚           â”œâ”€â”€ auth.py       # ç”¨æˆ¶èªè­‰ API
â”‚   â”‚           â”œâ”€â”€ ocr.py        # OCR ä¸Šå‚³ API
â”‚   â”‚           â”œâ”€â”€ recommendation.py  # AI å ±å‘Šç”Ÿæˆ API
â”‚   â”‚           â”œâ”€â”€ chat.py       # å°è©± API
â”‚   â”‚           â”œâ”€â”€ nutrition.py  # ç‡Ÿé¤ŠæŸ¥è©¢ API
â”‚   â”‚           â”œâ”€â”€ food.py       # é£Ÿæå°é½Š APIï¼ˆ2026ï¼‰
â”‚   â”‚           â”œâ”€â”€ meals.py      # é£²é£Ÿç´€éŒ„ APIï¼ˆ2026ï¼‰
â”‚   â”‚           â””â”€â”€ users.py      # ä½¿ç”¨è€… API
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ocr_service.py        # Gemini Vision OCR
â”‚   â”‚   â”œâ”€â”€ ai_service.py         # AI å ±å‘Šç”Ÿæˆ + Chat
â”‚   â”‚   â”œâ”€â”€ knowledge_service.py  # RAG çŸ¥è­˜æª¢ç´¢
â”‚   â”‚   â”œâ”€â”€ nutrition_db_service.py  # ç‡Ÿé¤Šè³‡æ–™åº«æœå‹™
â”‚   â”‚   â””â”€â”€ food_alignment_service.py # é£Ÿæåç¨±å°é½Šæœå‹™ï¼ˆ2026ï¼‰
â”‚   â”œâ”€â”€ models/                   # SQLAlchemy ORM æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/                  # Pydantic Schema é©—è­‰
â”‚   â”œâ”€â”€ db/                        # SQLite/SQLAlchemy
â”‚   â”‚   â””â”€â”€ session.py             # DB Session
â”‚   â””â”€â”€ init_db.py                 # åˆå§‹åŒ–è³‡æ–™åº«ï¼ˆcreate_allï¼‰
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ knowledge_base/           # RAG çŸ¥è­˜åº«
â”‚   â”‚   â”œâ”€â”€ general_guidelines.md      # å°ç£é£²é£ŸæŒ‡å— ~1,200 å­—
â”‚   â”‚   â”œâ”€â”€ supplement_safety.md       # ä¿å¥å“å®‰å…¨ ~800 å­—
â”‚   â”‚   â””â”€â”€ drug_interactions.md       # è—¥ç‰©äº¤äº’ä½œç”¨ ~600 å­—
â”‚   â”œâ”€â”€ é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº«2024UPDATE2.ods     # åŸå§‹ç‡Ÿé¤Šè³‡æ–™
â”‚   â”œâ”€â”€ é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº«2024UPDATE2.csv     # è½‰æ›å¾Œ CSV (2,180 ç­†)
â”‚   â””â”€â”€ nutrition_categories.txt               # é£Ÿå“åˆ†é¡å°ç…§
â”‚
â”œâ”€â”€ mobile/
â”‚   â””â”€â”€ flutter_app/              # Flutter å‰ç«¯
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â”œâ”€â”€ main.dart         # æ‡‰ç”¨ç¨‹å¼å…¥å£
â”‚       â”‚   â”œâ”€â”€ pages/
â”‚       â”‚   â”‚   â”œâ”€â”€ home_shell.dart       # ä¸»å°èˆª Shell
â”‚       â”‚   â”‚   â”œâ”€â”€ profile_page.dart     # å€‹äººè³‡æ–™é 
â”‚       â”‚   â”‚   â”œâ”€â”€ upload_page.dart      # ä¸Šå‚³å¥æª¢å ±å‘Šé 
â”‚       â”‚   â”‚   â”œâ”€â”€ dashboard_page.dart   # å¥åº·å„€è¡¨æ¿é 
â”‚       â”‚   â”‚   â”œâ”€â”€ chat_page.dart        # AI å°è©±é 
â”‚       â”‚   â”‚   â”œâ”€â”€ report_detail_page.dart  # å ±å‘Šè©³æƒ…é 
â”‚       â”‚   â”‚   â””â”€â”€ nutrition_search_page.dart  # ç‡Ÿé¤ŠæŸ¥è©¢é 
â”‚       â”‚   â”œâ”€â”€ services/
â”‚       â”‚   â”‚   â”œâ”€â”€ api_client.dart       # Dio HTTP å®¢æˆ¶ç«¯
â”‚       â”‚   â”‚   â”œâ”€â”€ report_service.dart   # å ±å‘Š API æœå‹™
â”‚       â”‚   â”‚   â”œâ”€â”€ chat_service.dart     # å°è©± API æœå‹™
â”‚       â”‚   â”‚   â””â”€â”€ nutrition_service.dart  # ç‡Ÿé¤Š API æœå‹™
â”‚       â”‚   â”œâ”€â”€ state/
â”‚       â”‚   â”‚   â””â”€â”€ app_state.dart        # Riverpod ç‹€æ…‹ç®¡ç†
â”‚       â”‚   â””â”€â”€ widgets/          # å¯è¤‡ç”¨å…ƒä»¶
â”‚       â”œâ”€â”€ pubspec.yaml          # Flutter ä¾è³´é…ç½®
â”‚       â””â”€â”€ ENV_CONFIG.md         # ç’°å¢ƒé…ç½®èªªæ˜
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ main.py                   # Streamlit Web ä»‹é¢
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_nutrition_db.py      # ç‡Ÿé¤Šè³‡æ–™åº«é©—è­‰è…³æœ¬
â”‚   â””â”€â”€ ...                        # å…¶ä»–æ¸¬è©¦
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ PHASE1_NUTRITION_DB_REPORT.md  # Phase 1 é©—æ”¶å ±å‘Š
â”‚   â””â”€â”€ ...                             # å…¶ä»–æ–‡æª”
â”‚
â”œâ”€â”€ requirements.txt               # Python ä¾è³´
â”œâ”€â”€ .env                          # ç’°å¢ƒè®Šæ•¸ (Gemini API Key)
â””â”€â”€ README.md                     # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

---

## ğŸ“¡ API ç«¯é»å®Œæ•´æ¸…å–®

### **Base URL**
```
http://127.0.0.1:8000/api/v1
```

### **1. èªè­‰ API**
| ç«¯é» | æ–¹æ³• | æè¿° | è«‹æ±‚é«”ç¯„ä¾‹ |
|------|------|------|-----------|
| `/auth/register` | POST | ç”¨æˆ¶è¨»å†Š | `{"email": "user@example.com", "password": "...", "name": "å¼µä¸‰"}` |
| `/auth/login` | POST | ç”¨æˆ¶ç™»å…¥ | `{"email": "user@example.com", "password": "..."}` |

### **2. OCR API**
| ç«¯é» | æ–¹æ³• | æè¿° | è«‹æ±‚åƒæ•¸ |
|------|------|------|---------|
| `/ocr/upload` | POST | ä¸Šå‚³å¥æª¢å ±å‘Šåœ–ç‰‡ | `multipart/form-data` (file, user_id) |

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "success": true,
  "data": {
    "glucose": {"value": 169, "unit": "mg/dL", "status": "high"},
    "hba1c": {"value": 5.8, "unit": "%", "status": "normal"},
    "egfr": {"value": 76.38, "unit": "mL/min/1.73mÂ²", "status": "low"}
  }
}
```

### **3. AI å ±å‘Šç”Ÿæˆ API**
| ç«¯é» | æ–¹æ³• | æè¿° | è«‹æ±‚é«”ç¯„ä¾‹ |
|------|------|------|-----------|
| `/recommendation/generate` | POST | ç”Ÿæˆå®Œæ•´ç‡Ÿé¤Šå»ºè­°å ±å‘Š | `{"user_id": 1, "health_data": {...}}` |

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "health_data_snapshot": {...},
  "health_score": 82,
  "risk_assessment": {
    "è¡€ç³–åé«˜": {"level": "high", "reason": "ç©ºè…¹è¡€ç³– 169 è¶…éæ­£å¸¸å€¼ä¸Šé™ 100"},
    "è…åŠŸèƒ½åä½": {"level": "medium", "reason": "eGFR 76.38 ä½æ–¼ 90"}
  },
  "food_advice": [
    {
      "title": "é£²é£ŸåŸå‰‡",
      "content": "å»ºè­°æ¡ç”¨ä½ GI é£²é£Ÿ...",
      "priority": "high"
    }
  ],
  "supplement_advice": [...],
  "meal_plan": {
    "Monday": {
      "breakfast": "ç‡•éº¥ç²¥ + ç„¡ç³–è±†æ¼¿ + æ°´ç…®è›‹",
      "lunch": "ç³™ç±³é£¯ + æ¸…è’¸é­š + ç‚’é’èœ",
      "dinner": "...",
      "notes": "..."
    }
  }
}
```

### **4. Chat å°è©± API**
| ç«¯é» | æ–¹æ³• | æè¿° | è«‹æ±‚é«”ç¯„ä¾‹ |
|------|------|------|-----------|
| `/chat/message` | POST | AI ç‡Ÿé¤Šå¸«å°è©± | `{"user_id": 1, "message": "æˆ‘å¯ä»¥åƒé¦™è•‰å—ï¼Ÿ", "context": {...}, "history": [...]}` |

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "response": "æ‚¨çš„ eGFR 76.38 å±¬æ–¼è¼•åº¦è…åŠŸèƒ½ä¸‹é™ï¼Œé¦™è•‰å«é‰€é‡é«˜ï¼ˆç´„ 358mg/100gï¼‰ï¼Œå»ºè­°æ¯æ—¥æ”å–ä¸è¶…é 1 æ ¹ä¸­å‹é¦™è•‰..."
}
```

### **5. ç‡Ÿé¤ŠæŸ¥è©¢ API (Phase 1)**
| ç«¯é» | æ–¹æ³• | æè¿° | æŸ¥è©¢åƒæ•¸ |
|------|------|------|---------|
| `/nutrition/search` | GET | æœå°‹é£Ÿç‰© | `q=é›èƒ¸è‚‰&limit=5` |
| `/nutrition/calculate` | GET | è¨ˆç®—ç‡Ÿé¤Š | `food=ç™½é£¯&grams=200` |
| `/nutrition/categories` | GET | å–å¾—é£Ÿå“åˆ†é¡ | - |
| `/nutrition/stats` | GET | å–å¾—çµ±è¨ˆè³‡è¨Š | - |
| `/nutrition/validate` | GET | é©—è­‰åŒ¹é…ç‡ | - |
| `/nutrition/health` | GET | å¥åº·æª¢æŸ¥ | - |

**æœå°‹å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "results": [
    {
      "name": "é›èƒ¸è‚‰",
      "category": "è‚‰é¡",
      "nutrients_per_100g": {
        "calories": 165,
        "protein": 31.0,
        "carbs": 0.0,
        "fat": 3.6,
        "sodium": 74,
        "potassium": 370,
        "fiber": 0.0
      }
    }
  ],
  "total": 1
}
```

---

## ğŸ§ª æ¸¬è©¦èˆ‡é©—è­‰

### **ç‡Ÿé¤Šè³‡æ–™åº«é©—è­‰**
```bash
python test_nutrition_db.py
```

**é©—æ”¶æ¨™æº–**ï¼š
- âœ… Top 20 å¸¸è¦‹é£Ÿç‰©åŒ¹é…ç‡ â‰¥80% (å¯¦éš›ï¼š**100%**)
- âœ… æŸ¥è©¢æ•ˆèƒ½ <100ms (å¯¦éš›ï¼š**0.66ms**)
- âœ… è³‡æ–™å®Œæ•´æ€§ â‰¥2000ç­† (å¯¦éš›ï¼š**2,180ç­†**)

### **API æ¸¬è©¦**
```powershell
# OCR API
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/v1/ocr/upload" `
  -Method Post -Form @{file=Get-Item "test_report.jpg"; user_id=1}

# Chat API
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/v1/chat/message" `
  -Method Post -ContentType "application/json" `
  -Body '{"user_id":1,"message":"æˆ‘å¯ä»¥åƒé¦™è•‰å—ï¼Ÿ"}'

# Nutrition API
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/v1/nutrition/search?q=é›èƒ¸è‚‰&limit=5"
```

---

## ğŸ’¡ æŠ€è¡“äº®é»ç¸½çµ

### **1. AI å·¥ç¨‹å‰µæ–°**
- âœ… **RAG æ¶æ§‹**ï¼šé¿å… AI å¹»è¦ºï¼ŒåŸºæ–¼å°ç£é£²é£ŸæŒ‡å—å›ç­”
- âœ… **ä¸¦è¡Œç”Ÿæˆ**ï¼šasyncio.gather() æå‡ 3 å€æ•ˆèƒ½ (44s vs 130s)
- âœ… **å‹•æ…‹è©•åˆ†**ï¼šåŸºæ–¼å¥åº·é¢¨éšªè¨ˆç®— 0-100 åˆ†å¥åº·æŒ‡æ•¸

### **2. ç³»çµ±è¨­è¨ˆ**
- âœ… **éš”é›¢ç­–ç•¥**ï¼šç‡Ÿé¤Šè³‡æ–™åº«ç¨ç«‹ APIï¼Œä¸å½±éŸ¿ä¸»ç³»çµ±
- âœ… **Pydantic é˜²ç¦¦**ï¼šåš´æ ¼ Schema é©—è­‰é˜²æ­¢é‹è¡Œæ™‚éŒ¯èª¤
- âœ… **Context-Aware Chat**ï¼šçµåˆå¥åº·å ±å‘Š + çŸ¥è­˜åº« + å°è©±æ­·å²

### **3. è³‡æ–™è™•ç†**
- âœ… **å¤šå±¤åŒ¹é…**ï¼šç²¾ç¢º â†’ åˆ¥å â†’ æ¨¡ç³Š â†’ åˆ†è©ï¼ˆ4 å±¤ç­–ç•¥ï¼‰
- âœ… **å°ç£åœ¨åœ°åŒ–**ï¼šTop 20 åˆ¥åæ˜ å°„ï¼ˆå¦‚ã€ŒåŒ—è•‰ã€â†’ã€Œé¦™è•‰ã€ï¼‰
- âœ… **é«˜æ•ˆèƒ½**ï¼š0.66ms æŸ¥è©¢é€Ÿåº¦ + lru_cache å„ªåŒ–

### **4. è·¨å¹³å°æ”¯æ´**
- âœ… **Flutter**ï¼šWindows Desktop + Android + iOSï¼ˆå–®ä¸€ç¨‹å¼ç¢¼åº«ï¼‰
- âœ… **Riverpod**ï¼šé¡å‹å®‰å…¨çš„ç‹€æ…‹ç®¡ç†
- âœ… **Dio**ï¼šå„ªé›…çš„ HTTP å®¢æˆ¶ç«¯èˆ‡éŒ¯èª¤è™•ç†

---

## ğŸ“š é–‹ç™¼éšæ®µèˆ‡ç‰ˆæœ¬

### âœ… å·²å®ŒæˆåŠŸèƒ½
- **å€‹äººæª”æ¡ˆç®¡ç†**ï¼šå®Œæ•´è¡¨å–®é©—è­‰ï¼ˆå§“å/å¹´é½¡/èº«é«˜/é«”é‡ï¼‰
- **å¥æª¢å ±å‘Šä¸Šå‚³**ï¼šæ”¯æ´æ‹ç…§èˆ‡ç›¸ç°¿é¸å–ï¼Œè‡ªå‹• OCR è§£æ
- **å¥åº·å„€è¡¨æ¿**ï¼šè¶¨å‹¢åœ–è¡¨ã€ç•°å¸¸æŒ‡æ¨™ã€AI å»ºè­°å¡ç‰‡
- **AI å°è©±**ï¼šä¸Šä¸‹æ–‡ç†è§£ã€è‡ªå‹•æ²å‹•ã€æ™‚é–“æˆ³è¨˜ã€æ¸…é™¤å°è©±
- **ç’°å¢ƒé…ç½®**ï¼šæ”¯æ´ dev/staging/production ä¸‰ç¨®ç’°å¢ƒåˆ‡æ›

### ğŸ¯ æŠ€è¡“äº®é»
- **è¡¨å–®é©—è­‰**ï¼šå³æ™‚éŒ¯èª¤æç¤ºï¼Œä¿éšœæ•¸æ“šè³ªé‡
- **ç‹€æ…‹ç®¡ç†**ï¼šRiverpod çµ±ä¸€ç®¡ç†å…¨å±€ç‹€æ…‹
- **API æ•´åˆ**ï¼šDio + ç’°å¢ƒé…ç½®ï¼Œæ”¯æ´æ—¥èªŒæ””æˆª
- **UX å„ªåŒ–**ï¼šLoading ç‹€æ…‹ã€éŒ¯èª¤è™•ç†ã€å‹å–„æç¤º

---

## ğŸ“Š API ç«¯é»

### ä½¿ç”¨è€…ç®¡ç†
- `POST /api/v1/users/` - å»ºç«‹ä½¿ç”¨è€…æª”æ¡ˆ
- `GET /api/v1/users/{user_id}/history` - æŸ¥è©¢æ­·å²è¨˜éŒ„

### OCR è™•ç†
- `POST /api/v1/ocr/upload` - ä¸Šå‚³å¥æª¢å ±å‘Š
- `GET /api/v1/ocr/result/{file_id}` - æŸ¥è©¢è§£æçµæœ

### AI æ¨è–¦
- `POST /api/v1/recommendation/generate` - ç”Ÿæˆå¥åº·å»ºè­°

### AI å°è©±
- `POST /api/v1/chat/message` - ç™¼é€è¨Šæ¯ï¼ˆæ”¯æ´å°è©±æ­·å²ï¼‰

### é£Ÿæå°é½Šï¼ˆ2026ï¼‰
- `GET /api/v1/food/align?q=é›èƒ¸è‚‰&limit=5` - é£Ÿæåç¨±å°é½Šåˆ°æ¬Šå¨ `food_id`

### é£²é£Ÿç´€éŒ„ï¼ˆ2026ï¼‰
- `POST /api/v1/meals` - æ–°å¢ä¸€é¤ï¼ˆå¯å¤šé£Ÿæï¼‰
- `GET /api/v1/meals?user_id=...&limit=10` - è¿‘æœŸé¤æ¬¡åˆ—è¡¨
- `GET /api/v1/meals/summary?user_id=...&days=7` - è¿‘ N æ—¥ç‡Ÿé¤Šç¸½çµ

API æ–‡æª”ï¼š`http://localhost:8000/docs`

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
personalhealth/
â”œâ”€â”€ app/                              # FastAPI å¾Œç«¯
â”‚   â”œâ”€â”€ main.py                      # API ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ models/                      # è³‡æ–™åº«æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/                     # Pydantic Schemas
â”‚   â”œâ”€â”€ services/                    # æ¥­å‹™é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ ocr_service.py          # OCR å¼•æ“
â”‚   â”‚   â”œâ”€â”€ ai_service.py           # AI æ¨è–¦å¼•æ“
â”‚   â”‚   â”œâ”€â”€ knowledge_service.py    # RAG çŸ¥è­˜æª¢ç´¢
â”‚   â”‚   â”œâ”€â”€ nutrition_db_service.py # ç‡Ÿé¤Šè³‡æ–™åº«æœå‹™
â”‚   â”‚   â””â”€â”€ food_alignment_service.py # é£Ÿæåç¨±å°é½Šæœå‹™ï¼ˆ2026ï¼‰
â”‚   â””â”€â”€ api/                         # API ç«¯é»
â”œâ”€â”€ frontend/                        # Streamlit å‰ç«¯
â”‚   â””â”€â”€ main.py                     # Web UI
â”œâ”€â”€ mobile/flutter_app/              # Flutter è·¨å¹³å° App
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ pages/                  # UI é é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ profile_page.dart   # å€‹äººè³‡æ–™ï¼ˆå«é©—è­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ upload_page.dart    # å ±å‘Šä¸Šå‚³
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard_page.dart # å¥åº·å„€è¡¨æ¿
â”‚   â”‚   â”‚   â””â”€â”€ chat_page.dart      # AI å°è©±ï¼ˆå« UX å„ªåŒ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ services/               # API æœå‹™å±¤
â”‚   â”‚   â”œâ”€â”€ models/                 # è³‡æ–™æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ state/                  # Riverpod ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â””â”€â”€ config/
â”‚   â”‚       â””â”€â”€ api_config.dart     # ç’°å¢ƒé…ç½®
â”‚   â””â”€â”€ ENV_CONFIG.md               # ç’°å¢ƒåˆ‡æ›èªªæ˜
â”œâ”€â”€ data/                            # è³‡æ–™æª”æ¡ˆ
â”œâ”€â”€ uploads/                         # ä¸Šå‚³æª”æ¡ˆæš«å­˜
â”œâ”€â”€ 01_æŠ€è¡“è¦æ ¼æ–‡ä»¶_MVPæ ¸å¿ƒæ¶æ§‹.md
â”œâ”€â”€ 02_OCRè™•ç†è©³ç´°è¦æ ¼èˆ‡å¯¦ä½œæŒ‡å—.md
â”œâ”€â”€ 03_æ¨è–¦å¼•æ“è¨­è¨ˆèˆ‡è¦å‰‡é…ç½®æŒ‡å—.md
â””â”€â”€ 04_é–‹ç™¼ä»»å‹™è¨ˆç•«_TaskPlan.md
```

---

## ğŸ“š é–‹ç™¼éšæ®µèˆ‡ç‰ˆæœ¬

### âœ… **Phase 1: æ ¸å¿ƒ MVP**ï¼ˆå·²å®Œæˆ - 2025-11ï¼‰
**åŠŸèƒ½**ï¼š
- âœ… Google Gemini Vision API å¤šæ¨¡æ…‹ OCR å¼•æ“ï¼ˆ40+ æª¢é©—é …ç›®ï¼‰
- âœ… AI ç‡Ÿé¤Šæ¨è–¦ç³»çµ±ï¼ˆä¸¦è¡Œç”Ÿæˆ 3 æ¨¡çµ„ï¼šé£²é£Ÿ/ä¿å¥å“/é¤è¨ˆåŠƒï¼‰
- âœ… FastAPI å¾Œç«¯æ¶æ§‹ + Pydantic Schema é©—è­‰
- âœ… Streamlit Web ä»‹é¢ï¼ˆåŸå‹é©—è­‰ï¼‰

**æŠ€è¡“çªç ´**ï¼š
- Gemini Vision ç²¾æº–è¾¨è­˜å°ç£å¥æª¢å ±å‘Šæ ¼å¼
- asyncio.gather() ä¸¦è¡Œç”Ÿæˆæå‡ 3 å€æ•ˆèƒ½
- Structured JSON è¼¸å‡ºé˜²æ­¢ AI å¹»è¦º

---

### âœ… **Phase 2: æ·±åº¦å€‹äººåŒ– + RAG**ï¼ˆå·²å®Œæˆ - 2025-12ï¼‰
**åŠŸèƒ½**ï¼š
- âœ… RAG çŸ¥è­˜åº«æ•´åˆï¼ˆ3 å€‹ MD æ–‡ä»¶ï¼šå°ç£é£²é£ŸæŒ‡å—/ä¿å¥å“å®‰å…¨/è—¥ç‰©äº¤äº’ä½œç”¨ï¼‰
- âœ… å°è©±å¼ AI äº’å‹•ï¼ˆContext-Aware Chat + 10 è¼ªæ­·å²è¨˜æ†¶ï¼‰
- âœ… è¶¨å‹¢è¿½è¹¤èˆ‡æ•¸æ“šå°æ¯”ï¼ˆå¥åº·æŒ‡æ¨™æ™‚é–“åºåˆ—åˆ†æï¼‰
- âœ… UI/UX æµç¨‹å„ªåŒ–ï¼ˆè‡ªå‹•æ²å‹•/æ™‚é–“æˆ³/æ¸…é™¤å°è©±ï¼‰

**æŠ€è¡“çªç ´**ï¼š
- Tag-based çŸ¥è­˜æª¢ç´¢é¿å…å‘é‡è³‡æ–™åº«æˆæœ¬
- Prompt Engineering é˜²æ­¢ AI åè¦‹ï¼ˆå°ˆæ¥­ Persona è¨­è¨ˆï¼‰
- å‹•æ…‹å¥åº·è©•åˆ†ç³»çµ±ï¼ˆ0-100 åˆ†ï¼‰

---

### âœ… **Phase 3: ç‡Ÿé¤Šè³‡æ–™åº«æ•´åˆï¼ˆPhase 1 MVPï¼‰**ï¼ˆå·²å®Œæˆ - 2026-01ï¼‰
**åŠŸèƒ½**ï¼š
- âœ… å°ç£é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº« 2024 UPDATE2ï¼ˆ2,180 ç­†é£Ÿç‰© Ã— 110 ç‡Ÿé¤Šæ¬„ä½ï¼‰
- âœ… ç‡Ÿé¤ŠæŸ¥è©¢ APIï¼ˆæœå°‹/è¨ˆç®—/çµ±è¨ˆ 6 å€‹ç¨ç«‹ç«¯é»ï¼‰
- âœ… Flutter ç‡Ÿé¤ŠæŸ¥è©¢é é¢ï¼ˆæ”¯æ´å…‹æ•¸è¨ˆç®—ï¼‰
- âœ… é©—æ”¶æ¸¬è©¦ï¼ˆ100% Top 20 åŒ¹é…ç‡ + 0.66ms æŸ¥è©¢æ•ˆèƒ½ï¼‰

**æŠ€è¡“çªç ´**ï¼š
- å¤šå±¤åŒ¹é…ç®—æ³•ï¼šç²¾ç¢º â†’ åˆ¥å â†’ æ¨¡ç³Š â†’ åˆ†è©ï¼ˆ4 å±¤ç­–ç•¥ï¼‰
- å°ç£åœ¨åœ°åŒ–åˆ¥åæ˜ å°„ï¼ˆå¦‚ã€ŒåŒ—è•‰ã€â†’ã€Œé¦™è•‰ã€ï¼‰
- éš”é›¢ç­–ç•¥è¨­è¨ˆï¼ˆç¨ç«‹ API ä¸å½±éŸ¿ä¸»ç³»çµ±ï¼‰

**é©—æ”¶æˆæœ**ï¼š
| æŒ‡æ¨™ | ç›®æ¨™ | å¯¦éš› | ç‹€æ…‹ |
|------|------|------|------|
| Top 20 åŒ¹é…ç‡ | â‰¥80% | **100%** (20/20) | âœ… |
| æŸ¥è©¢æ•ˆèƒ½ | <100ms | **0.66ms** | âœ… |
| è³‡æ–™å®Œæ•´æ€§ | â‰¥2000ç­† | **2,180ç­†** | âœ… |

---

### âœ… **Phase 4: Flutter è·¨å¹³å° App**ï¼ˆå·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½ - 2026-01ï¼‰
**åŠŸèƒ½**ï¼š
- âœ… Flutter 3.27 å°ˆæ¡ˆæ¶æ§‹ï¼ˆWindows Desktop/Android/iOSï¼‰
- âœ… å®Œæ•´ UI å¯¦ç¾ï¼ˆProfile/Upload/Dashboard/Chat/Nutrition 5 é é¢ï¼‰
- âœ… Riverpod ç‹€æ…‹ç®¡ç†ï¼ˆuserProfile/healthReports/chatHistoryï¼‰
- âœ… è¡¨å–®é©—è­‰ç³»çµ±ï¼ˆå³æ™‚éŒ¯èª¤æç¤º + è³‡æ–™æ¸…ç†ï¼‰
- âœ… API ç’°å¢ƒé…ç½®ç³»çµ±ï¼ˆdev/staging/productionï¼‰
- âœ… Windows æ¡Œé¢ç‰ˆæˆåŠŸé‹è¡Œ

**æŠ€è¡“äº®é»**ï¼š
- å–®ä¸€ç¨‹å¼ç¢¼åº«è·¨ 3 å¹³å°ï¼ˆWindows/Android/iOSï¼‰
- Dio HTTP å®¢æˆ¶ç«¯å„ªé›…éŒ¯èª¤è™•ç†
- fl_chart å¥åº·è¶¨å‹¢åœ–è¡¨ç¹ªè£½
- flutter_markdown å®Œæ•´å ±å‘Šæ¸²æŸ“

**å¾…å®Œæˆ**ï¼š
- â³ Android/iOS çœŸæ©Ÿæ¸¬è©¦
- â³ App Store / Google Play ä¸Šæ¶æº–å‚™

---

### ğŸš§ **Phase 5: ç”¢å“åŒ–èˆ‡éƒ¨ç½²**ï¼ˆé€²è¡Œä¸­ï¼‰
**è¨ˆåŠƒåŠŸèƒ½**ï¼š
- â³ JWT èªè­‰ç³»çµ±ï¼ˆToken-based å®‰å…¨èªè­‰ï¼‰
- â³ è³‡æ–™åŠ å¯†ï¼ˆå¥æª¢å ±å‘Š AES-256 åŠ å¯†ï¼‰
- â³ Docker å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆBackend + Frontendï¼‰
- â³ CI/CD æµç¨‹ï¼ˆGitHub Actionsï¼‰
- â³ HTTPS éƒ¨ç½²ï¼ˆLet's Encryptï¼‰

---

## ğŸ”§ ç’°å¢ƒé…ç½®èªªæ˜

### **å¾Œç«¯ç’°å¢ƒè®Šæ•¸ (.env)**
```bash
# Google Gemini API Key (å¿…å¡«)
GEMINI_API_KEY=your_api_key_here

# è³‡æ–™åº«é…ç½®
DATABASE_URL=sqlite:///./personal_health.db

# JWT é…ç½®ï¼ˆPhase 5ï¼‰
JWT_SECRET_KEY=your_secret_key
JWT_ALGORITHM=HS256
```

### **Flutter ç’°å¢ƒåˆ‡æ›**
è©³è¦‹ [mobile/flutter_app/ENV_CONFIG.md](mobile/flutter_app/ENV_CONFIG.md)

```bash
# é–‹ç™¼ç’°å¢ƒï¼ˆé è¨­ï¼‰- ä½¿ç”¨ 127.0.0.1:8000
flutter run

# Windows çœŸæ©Ÿæ¸¬è©¦ - ä½¿ç”¨é›»è…¦ IP
# å…ˆä¿®æ”¹ lib/config/api_config.dart çš„ development baseUrl
flutter run -d windows

# æ­£å¼ç’°å¢ƒ
flutter run --dart-define=ENV=production
```

### **Flutter è¡¨å–®é©—è­‰è¦å‰‡**
```dart
// ProfilePage é©—è­‰é‚è¼¯
å§“åï¼šâ‰¥2 å­—å…ƒï¼ˆä¸­æ–‡æˆ–è‹±æ–‡ï¼‰
å¹´é½¡ï¼š1-120 æ­²ï¼ˆæ•´æ•¸ï¼‰
èº«é«˜ï¼š50-250 cmï¼ˆå°æ•¸é»å¾Œ 1 ä½ï¼‰
é«”é‡ï¼š20-300 kgï¼ˆå°æ•¸é»å¾Œ 1 ä½ï¼‰
```

---

## ğŸ§° å®Œæ•´æŠ€è¡“æ£§

### **å¾Œç«¯æŠ€è¡“**
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” | é—œéµç‰¹æ€§ |
|------|------|------|---------|
| **FastAPI** | 0.104+ | Web æ¡†æ¶ | è‡ªå‹• OpenAPI æ–‡æª”ã€é«˜æ•ˆèƒ½ async |
| **Python** | 3.13 | ä¸»è¦èªè¨€ | é¡å‹æç¤ºã€ç¾ä»£èªæ³• |
| **Pydantic** | 2.12+ | Schema é©—è­‰ | é˜²æ­¢é‹è¡Œæ™‚éŒ¯èª¤ã€è‡ªå‹•è½‰æ› |
| **SQLAlchemy** | 2.0+ | ORM | é¡å‹å®‰å…¨ã€æ”¯æ´ async |
| **SQLite** | - | è³‡æ–™åº« | è¼•é‡ã€é›¶é…ç½® |
| **Uvicorn** | Latest | ASGI Server | é«˜æ•ˆèƒ½ã€æ”¯æ´ WebSocket |
| **google-generativeai** | Latest | AI SDK | Gemini API å®˜æ–¹ SDK |
| **Pandas** | 2.3.3 | è³‡æ–™è™•ç† | ç‡Ÿé¤Šè³‡æ–™åº«è®€å– |
| **odfpy** | Latest | ODS è§£æ | å°ç£ç‡Ÿé¤Šè³‡æ–™åº«æ ¼å¼ |

### **å‰ç«¯æŠ€è¡“**
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” | é—œéµç‰¹æ€§ |
|------|------|------|---------|
| **Flutter** | 3.27+ | UI æ¡†æ¶ | å–®ä¸€ç¨‹å¼ç¢¼åº«è·¨å¹³å° |
| **Dart** | 3.5+ | ä¸»è¦èªè¨€ | é¡å‹å®‰å…¨ã€Null Safety |
| **Riverpod** | 2.5.1 | ç‹€æ…‹ç®¡ç† | ç·¨è­¯æ™‚å®‰å…¨ã€æ˜“æ¸¬è©¦ |
| **Dio** | 5.x | HTTP å®¢æˆ¶ç«¯ | æ””æˆªå™¨ã€éŒ¯èª¤è™•ç† |
| **fl_chart** | 0.68.0 | åœ–è¡¨åº« | è¶¨å‹¢åœ–ã€æŠ˜ç·šåœ– |
| **flutter_markdown** | 0.7.4 | Markdown æ¸²æŸ“ | å®Œæ•´å ±å‘Šé¡¯ç¤º |
| **image_picker** | Latest | åœ–ç‰‡é¸å– | ç›¸æ©Ÿ/ç›¸ç°¿æ•´åˆ |
| **Streamlit** | Latest | Web UIï¼ˆå‚™ç”¨ï¼‰ | å¿«é€ŸåŸå‹é©—è­‰ |

### **AI æŠ€è¡“**
| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” | é—œéµç‰¹æ€§ |
|------|------|------|---------|
| **Google Gemini** | 2.0 Flash Exp | å¤šæ¨¡æ…‹ AI | Vision OCR + Text Generation |
| **RAG** | - | çŸ¥è­˜æª¢ç´¢ | é˜²æ­¢ AI å¹»è¦ºã€åŸºæ–¼å°ç£æŒ‡å— |
| **asyncio** | - | ä¸¦è¡Œè™•ç† | 3 å€‹ AI æ¨¡çµ„åŒæ™‚ç”Ÿæˆ |

### **è³‡æ–™ä¾†æº**
| è³‡æ–™ | ç‰ˆæœ¬ | å…§å®¹ | æ ¼å¼ |
|------|------|------|------|
| **å°ç£é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº«** | 2024 UPDATE2 | 2,180 ç­†é£Ÿç‰© Ã— 110 æ¬„ä½ | ODS/CSV |
| **çŸ¥è­˜åº«** | è‡ªè£½ | é£²é£ŸæŒ‡å—/ä¿å¥å“/è—¥ç‰©äº¤äº’ä½œç”¨ | Markdown (3 files) |

---

## ğŸ‰ ç‰ˆæœ¬æ›´æ–°æ—¥èªŒ

### **v2.0.0** (2026-01-17) - ğŸŠ ç‡Ÿé¤Šè³‡æ–™åº«æ•´åˆå®Œæˆ
**æ–°åŠŸèƒ½**ï¼š
- âœ¨ å°ç£é£Ÿå“ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº« 2024 å®Œæ•´æ•´åˆ
- âœ¨ ç‡Ÿé¤ŠæŸ¥è©¢ APIï¼ˆ6 å€‹ç¨ç«‹ç«¯é»ï¼‰
- âœ¨ Flutter ç‡Ÿé¤ŠæŸ¥è©¢é é¢ï¼ˆæ”¯æ´å…‹æ•¸è¨ˆç®—ï¼‰
- âœ¨ Top 20 é£Ÿç‰©åˆ¥åæ˜ å°„ï¼ˆ100% åŒ¹é…ç‡ï¼‰

**æŠ€è¡“æ”¹é€²**ï¼š
- ğŸš€ å¤šå±¤åŒ¹é…ç®—æ³•ï¼ˆç²¾ç¢º/åˆ¥å/æ¨¡ç³Š/åˆ†è©ï¼‰
- ğŸš€ æŸ¥è©¢æ•ˆèƒ½å„ªåŒ–ï¼ˆ0.66ms å¹³å‡éŸ¿æ‡‰æ™‚é–“ï¼‰
- ğŸš€ éš”é›¢ API è¨­è¨ˆï¼ˆä¸å½±éŸ¿ä¸»ç³»çµ±ï¼‰

**æ–‡æª”æ›´æ–°**ï¼š
- ğŸ“ PHASE1_NUTRITION_DB_REPORT.md é©—æ”¶å ±å‘Š
- ğŸ“ README.md å®Œæ•´æŠ€è¡“æ¶æ§‹æ–‡æª”

---

### **v1.2.0** (2026-01-10) - ğŸ¨ Flutter App å®Œæ•´å¯¦ç¾
**æ–°åŠŸèƒ½**ï¼š
- âœ¨ Flutter è·¨å¹³å° Appï¼ˆWindows/Android/iOSï¼‰
- âœ¨ è¡¨å–®é©—è­‰ç³»çµ±ï¼ˆå³æ™‚éŒ¯èª¤æç¤ºï¼‰
- âœ¨ API ç’°å¢ƒé…ç½®ç³»çµ±ï¼ˆdev/staging/productionï¼‰
- âœ¨ Chat UX å„ªåŒ–ï¼ˆè‡ªå‹•æ²å‹•ã€æ™‚é–“æˆ³ã€æ¸…é™¤å°è©±ï¼‰

**æŠ€è¡“æ”¹é€²**ï¼š
- ğŸš€ Riverpod ç‹€æ…‹ç®¡ç†é‡æ§‹
- ğŸš€ Dio HTTP å®¢æˆ¶ç«¯å„ªé›…éŒ¯èª¤è™•ç†
- ğŸš€ Windows æ¡Œé¢ç‰ˆæˆåŠŸé‹è¡Œ

---

### **v1.1.0** (2025-12-20) - ğŸ§  RAG å°è©±ç³»çµ±
**æ–°åŠŸèƒ½**ï¼š
- âœ¨ RAG çŸ¥è­˜åº«æ•´åˆï¼ˆ3 å€‹ Markdown æ–‡ä»¶ï¼‰
- âœ¨ Context-Aware Chatï¼ˆçµåˆå¥åº·å ±å‘Šï¼‰
- âœ¨ è¶¨å‹¢è¿½è¹¤åŠŸèƒ½ï¼ˆå¥åº·æŒ‡æ¨™æ™‚é–“åºåˆ—ï¼‰

**æŠ€è¡“æ”¹é€²**ï¼š
- ğŸš€ Tag-based çŸ¥è­˜æª¢ç´¢ï¼ˆç°¡å–®ä½†æœ‰æ•ˆï¼‰
- ğŸš€ Prompt Engineering å„ªåŒ–ï¼ˆå°ˆæ¥­ Personaï¼‰
- ğŸš€ å‹•æ…‹å¥åº·è©•åˆ†ç®—æ³•

---

### **v1.0.0** (2025-11-15) - ğŸ‰ æ ¸å¿ƒ MVP ä¸Šç·š
**åˆå§‹åŠŸèƒ½**ï¼š
- âœ¨ Google Gemini Vision OCRï¼ˆ40+ æª¢é©—é …ç›®ï¼‰
- âœ¨ AI ç‡Ÿé¤Šæ¨è–¦å¼•æ“ï¼ˆä¸¦è¡Œç”Ÿæˆ 3 æ¨¡çµ„ï¼‰
- âœ¨ FastAPI å¾Œç«¯ + Streamlit Web UI
- âœ¨ SQLite è³‡æ–™åº« + SQLAlchemy ORM

**æŠ€è¡“åŸºç¤**ï¼š
- ğŸš€ Pydantic Schema åš´æ ¼é©—è­‰
- ğŸš€ asyncio ä¸¦è¡Œ AI ç”Ÿæˆ
- ğŸš€ Structured JSON é˜²æ­¢å¹»è¦º

---

## ğŸ¤ è²¢ç»æŒ‡å—

### **å¦‚ä½•è²¢ç»**
1. Fork æœ¬å°ˆæ¡ˆåˆ°ä½ çš„ GitHub
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/AmazingFeature`
3. æäº¤è®Šæ›´ï¼š`git commit -m 'Add AmazingFeature'`
4. æ¨é€åˆ°åˆ†æ”¯ï¼š`git push origin feature/AmazingFeature`
5. é–‹å•Ÿ Pull Request ä¸¦æè¿°ä½ çš„æ”¹å‹•

### **é–‹ç™¼è¦ç¯„**
- **Python**ï¼šéµå¾ª PEP 8 é¢¨æ ¼æŒ‡å—
- **Flutter**ï¼šéµå¾ª Effective Dart æŒ‡å—
- **Commit**ï¼šä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) æ ¼å¼
  - `feat: æ–°åŠŸèƒ½`
  - `fix: ä¿®å¾© Bug`
  - `docs: æ–‡æª”æ›´æ–°`
  - `refactor: ç¨‹å¼ç¢¼é‡æ§‹`

### **æ¸¬è©¦è¦æ±‚**
- å¾Œç«¯ï¼špytest è¦†è“‹ç‡ >80%
- Flutterï¼šWidget æ¸¬è©¦è¦†è“‹æ ¸å¿ƒé é¢

---

## ğŸ“„ æˆæ¬Šè³‡è¨Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ **MIT License** - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆ

```
MIT License

Copyright (c) 2025 Personal Health Team

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction...
```

---

## ğŸ“§ è¯çµ¡èˆ‡æ”¯æ´

### **å°ˆæ¡ˆåœ˜éšŠ**
- **ç¶­è­·è€…**ï¼šPersonal Health Team
- **Email**ï¼šsupport@personalhealth.ai
- **GitHub**ï¼š[github.com/personalhealth](https://github.com/personalhealth)

### **å•é¡Œå›å ±**
é‡åˆ° Bugï¼Ÿè«‹åˆ° [GitHub Issues](https://github.com/personalhealth/issues) æäº¤å•é¡Œå ±å‘Š

### **åŠŸèƒ½å»ºè­°**
æœ‰å¥½é»å­ï¼Ÿæ­¡è¿åˆ° [GitHub Discussions](https://github.com/personalhealth/discussions) åˆ†äº«

---

## ğŸ™ è‡´è¬

### **æŠ€è¡“æ”¯æ´**
- Google Gemini API æä¾›å¼·å¤§çš„å¤šæ¨¡æ…‹ AI èƒ½åŠ›
- å°ç£é£Ÿå“è—¥ç‰©ç®¡ç†ç½²æä¾›ç‡Ÿé¤Šæˆåˆ†è³‡æ–™åº«
- Flutter ç¤¾ç¾¤æä¾›è±å¯Œçš„é–‹ç™¼è³‡æº

### **é–‹æºå°ˆæ¡ˆ**
æ„Ÿè¬ä»¥ä¸‹é–‹æºå°ˆæ¡ˆï¼š
- FastAPI, Flutter, Riverpod
- Pandas, SQLAlchemy, Dio
- ä»¥åŠæ‰€æœ‰è²¢ç»è€… â¤ï¸

---

**â­ å¦‚æœé€™å€‹å°ˆæ¡ˆå°ä½ æœ‰å¹«åŠ©ï¼Œæ­¡è¿çµ¦æˆ‘å€‘ä¸€å€‹ Starï¼**
